ðŸ§­ Migration Roadmap: Procedural â†’ OOP Plugin Architecture
ðŸ”¹ Phase 1: Core Bootstrap & Loader
Goal: Centralize plugin loading, class autoloading, and lifecycle hooks.

Procedural File	Target Class	Purpose
decentralized-user-auth.php	class-plugin.php	Main bootstrap: loads classes, hooks, assets
activate.php	class-user-schema.php	Handles schema setup and MU plugin install
helpers.php	class-auth-token.php	Stateless token generation and linked account queries
âœ… We'll refactor dua_create_user_schema() and dua_add_mu_plugin() into methods inside DUA_User_Schema.

ðŸ”¹ Phase 2: User Linking & AJAX
Goal: Encapsulate all AJAX logic and linking flows.

Procedural File	Target Class	Purpose
linking-hooks.php	class-user-linker.php + class-ajax-controller.php	Linking, unlinking, token generation, remote login
âœ… We'll split responsibilities:

DUA_User_Linker: handles DB updates and validation

DUA_Ajax_Controller: registers and routes AJAX actions

ðŸ”¹ Phase 3: User Lifecycle Hooks
Goal: Enforce site isolation and deletion rules.

Procedural File	Target Class	Purpose
user-hooks.php	class-user-hooks.php	Hooks for user creation, deletion, and removal
âœ… Each hook becomes a method, registered via add_action() inside the class constructor.

ðŸ”¹ Phase 4: Admin UI
Goal: Modularize settings and linked accounts pages.

Procedural File	Target Class	Purpose
admin/settings-page.php	class-settings-page.php	Admin settings UI
admin/linked-accounts.php	class-linked-accounts-page.php	Linked accounts display
âœ… We'll move rendering logic into methods and optionally use views/ for HTML partials.

ðŸ”¹ Phase 5: Overrides & Core Extensions
Goal: Maintain decentralized identity logic via WP core overrides.

Procedural File	Target Class	Purpose
wordpress/wp-includes/class-wp-user.php	class-wp-user.php	DUA_WP_User class
wordpress/wp-includes/pluggable.php	pluggable.php	Override get_user_by()
âœ… We'll namespace DUA_WP_User and ensure it's loaded early via class-plugin.php.

ðŸ”¹ Phase 6: Assets, Translations, MU Loader
Goal: Ensure clean loading of styles, scripts, and translations.

Procedural File	Target Class	Purpose
admin.css, admin.js, roaming.js	Enqueued via class-plugin.php	Asset loading
languages/*.pot	Loaded via load_plugin_textdomain()	i18n support
mu-loader/*.php	Copied via DUA_User_Schema	Early cookie setup
ðŸ§± Class Naming Convention
All classes will follow this format:

php
class DUA_ClassName {
    // Methods and properties
}
Each file will be named:

Code
class-class-name.php
ðŸ§ª Final Phase: Testing & Review Alignment
Once refactored:

âœ… Validate WPCS compliance (phpcs --standard=WordPress)

âœ… Confirm multisite isolation and token flows

âœ… Ensure all hooks and AJAX endpoints are functional








require_once plugin_dir_path(__FILE__) . 'inc/class-plugin.php';
new DUA_Plugin();
